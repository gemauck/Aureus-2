<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ERP Diagnostics</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success {
            background: #0e4429;
            border-left: 4px solid #26a641;
        }
        .error {
            background: #5a1e1e;
            border-left: 4px solid #f85149;
        }
        .warning {
            background: #4d3800;
            border-left: 4px solid #d29922;
        }
        h1 { color: #58a6ff; }
        h2 { color: #79c0ff; margin-top: 30px; }
        pre {
            background: #161b22;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üîç Abcotronics ERP System Diagnostics</h1>
    <div id="diagnostics"></div>

    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script>
        const diagnostics = document.getElementById('diagnostics');
        
        function addStatus(message, type = 'success') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = message;
            diagnostics.appendChild(div);
        }

        function checkComponent(name, obj) {
            if (obj) {
                addStatus(`‚úÖ ${name} is loaded`, 'success');
                return true;
            } else {
                addStatus(`‚ùå ${name} is NOT loaded`, 'error');
                return false;
            }
        }

        // Check React
        addStatus('<h2>Core Libraries</h2>');
        checkComponent('React', window.React);
        checkComponent('ReactDOM', window.ReactDOM);
        
        if (window.React) {
            addStatus(`React version: ${React.version}`, 'success');
        }

        // Load all component files
        const componentFiles = [
            './src/utils/localStorage.js',
            './src/components/auth/AuthProvider.jsx',
            './src/components/auth/LoginPage.jsx',
            './src/components/dashboard/Dashboard.jsx',
            './src/components/clients/ClientModal.jsx',
            './src/components/clients/LeadModal.jsx',
            './src/components/clients/Clients.jsx',
            './src/components/projects/CustomFieldModal.jsx',
            './src/components/projects/SubtaskModal.jsx',
            './src/components/projects/TaskModal.jsx',
            './src/components/projects/ListModal.jsx',
            './src/components/projects/ProjectModal.jsx',
            './src/components/projects/ProjectDetail.jsx',
            './src/components/projects/Projects.jsx',
            './src/components/time/TimeModal.jsx',
            './src/components/time/TimeTracking.jsx',
            './src/components/invoicing/InvoicePreview.jsx',
            './src/components/invoicing/PaymentModal.jsx',
            './src/components/invoicing/RecurringInvoiceModal.jsx',
            './src/components/invoicing/CreditNoteModal.jsx',
            './src/components/invoicing/ExpenseModal.jsx',
            './src/components/invoicing/InvoiceReports.jsx',
            './src/components/invoicing/BankReconciliation.jsx',
            './src/components/invoicing/BatchInvoiceActions.jsx',
            './src/components/invoicing/InvoiceApprovalModal.jsx',
            './src/components/invoicing/DepositModal.jsx',
            './src/components/invoicing/ReminderSettings.jsx',
            './src/components/invoicing/NotesTemplateModal.jsx',
            './src/components/invoicing/InvoiceTemplateSelector.jsx',
            './src/components/invoicing/InvoiceModal.jsx',
            './src/components/invoicing/Invoicing.jsx',
            './src/components/layout/MainLayout.jsx',
            './src/App.jsx'
        ];

        let loaded = 0;
        componentFiles.forEach((file, index) => {
            const script = document.createElement('script');
            script.type = 'text/babel';
            script.src = file;
            script.onload = () => {
                loaded++;
                if (loaded === componentFiles.length) {
                    setTimeout(checkAllComponents, 1000);
                }
            };
            script.onerror = () => {
                addStatus(`‚ùå Failed to load: ${file}`, 'error');
            };
            document.body.appendChild(script);
        });

        function checkAllComponents() {
            addStatus('<h2>Component Status</h2>');
            
            // Utilities
            checkComponent('storage', window.storage);
            
            // Auth
            checkComponent('AuthProvider', window.AuthProvider);
            checkComponent('useAuth', window.useAuth);
            checkComponent('LoginPage', window.LoginPage);
            
            // Dashboard
            checkComponent('Dashboard', window.Dashboard);
            
            // Clients
            checkComponent('ClientModal', window.ClientModal);
            checkComponent('LeadModal', window.LeadModal);
            checkComponent('Clients', window.Clients);
            
            // Projects
            addStatus('<h2>Project Components</h2>');
            checkComponent('Projects', window.Projects);
            checkComponent('ProjectDetail', window.ProjectDetail);
            checkComponent('ProjectModal', window.ProjectModal);
            checkComponent('TaskModal', window.TaskModal);
            checkComponent('SubtaskModal', window.SubtaskModal);
            checkComponent('ListModal', window.ListModal);
            checkComponent('CustomFieldModal', window.CustomFieldModal);
            
            // Time Tracking
            checkComponent('TimeModal', window.TimeModal);
            checkComponent('TimeTracking', window.TimeTracking);
            
            // Invoicing
            addStatus('<h2>Invoicing Components</h2>');
            checkComponent('Invoicing', window.Invoicing);
            checkComponent('InvoiceModal', window.InvoiceModal);
            checkComponent('InvoicePreview', window.InvoicePreview);
            checkComponent('PaymentModal', window.PaymentModal);
            
            // Layout
            checkComponent('MainLayout', window.MainLayout);
            
            // App
            checkComponent('App', window.App);
            
            // Check for errors in console
            addStatus('<h2>Console Errors</h2>');
            addStatus('Check browser console (F12) for any JavaScript errors', 'warning');
            
            // List all window properties related to our app
            addStatus('<h2>All Window Properties</h2>');
            const appProps = Object.keys(window).filter(key => 
                key.includes('Modal') || 
                key.includes('Page') || 
                key === 'App' ||
                key === 'storage' ||
                key === 'Projects' ||
                key === 'Clients' ||
                key === 'Dashboard' ||
                key === 'Invoicing' ||
                key === 'TimeTracking' ||
                key === 'MainLayout'
            );
            
            if (appProps.length > 0) {
                addStatus(`Found ${appProps.length} app components on window:`, 'success');
                addStatus(`<pre>${appProps.join('\n')}</pre>`);
            } else {
                addStatus('No app components found on window!', 'error');
            }
        }
    </script>
</body>
</html>
