/* ============================================
   CRITICAL MOBILE FIX - Content Disappearing Below 766px
   This fixes the issue where all functionality disappears
   ============================================ */

/* Force proper layout at all widths */
html, body {
  width: 100% !important;
  max-width: 100vw !important;
  overflow-x: hidden !important;
  min-width: 320px !important;
}

/* Root container must be visible and properly sized */
#root {
  width: 100% !important;
  max-width: 100vw !important;
  min-width: 320px !important;
  display: flex !important;
  flex-direction: row !important;
  height: 100vh !important;
  overflow: hidden !important;
}

/* Main layout container */
#root > div {
  width: 100% !important;
  max-width: 100vw !important;
  display: flex !important;
  flex-direction: row !important;
  height: 100vh !important;
  overflow: hidden !important;
}

/* Ensure flex container works properly */
.flex.h-screen {
  width: 100% !important;
  max-width: 100vw !important;
  display: flex !important;
  height: 100vh !important;
  overflow: hidden !important;
}

/* Critical: Ensure main content is visible at all widths */
main,
.flex-1,
[class*="flex-1"] {
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
  width: 100% !important;
  max-width: 100% !important;
  min-width: 0 !important;
  flex: 1 1 auto !important;
  overflow-x: hidden !important;
  overflow-y: auto !important;
}

/* Ensure sidebar doesn't push content off screen */
@media (max-width: 1024px) {
  aside,
  [class*="sidebar"] {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    height: 100vh !important;
    z-index: 100 !important;
    transform: translateX(-100%) !important;
    transition: transform 0.3s ease !important;
  }
  
  /* When sidebar is open */
  aside[style*="display: flex"],
  aside:not([style*="display: none"]) {
    transform: translateX(0) !important;
  }
  
  /* Main content takes full width when sidebar is hidden */
  .flex.h-screen > div:last-child,
  main {
    width: 100vw !important;
    max-width: 100vw !important;
    margin-left: 0 !important;
  }
}

/* Critical fix for 766px and below */
@media (max-width: 766px) {
  /* Ensure everything is visible */
  * {
    visibility: visible !important;
    opacity: 1 !important;
  }
  
  /* Force proper display on all containers */
  #root,
  #root > div,
  .flex.h-screen,
  main,
  [class*="main-content"] {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    max-width: 100vw !important;
  }
  
  /* Ensure header is visible */
  header {
    display: flex !important;
    width: 100% !important;
    max-width: 100vw !important;
    flex-shrink: 0 !important;
  }
  
  /* Ensure main content area is visible and scrollable */
  main {
    flex: 1 !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    width: 100% !important;
    max-width: 100vw !important;
    padding: 12px !important;
  }
  
  /* All child elements must fit in viewport */
  main > * {
    max-width: 100% !important;
    width: 100% !important;
    box-sizing: border-box !important;
  }
  
  /* Fix any absolute positioning that breaks layout */
  .absolute:not(.dropdown):not([class*="menu"]) {
    position: relative !important;
  }
  
  /* Remove any min-width that causes overflow */
  * {
    min-width: 0 !important;
  }
  
  /* Exception: touch targets need minimum size */
  button,
  input,
  select,
  textarea,
  a[role="button"] {
    min-width: 44px !important;
    min-height: 44px !important;
  }
  
  /* Ensure flex items don't overflow */
  .flex > * {
    flex-shrink: 1 !important;
    min-width: 0 !important;
  }
  
  /* Tables that aren't converted yet */
  table {
    display: block !important;
    width: 100% !important;
    max-width: 100% !important;
    overflow-x: auto !important;
  }
  
  /* Fix grid layouts */
  .grid {
    grid-template-columns: 1fr !important;
    width: 100% !important;
  }
  
  /* Remove fixed widths that break layout */
  [style*="width:"] {
    width: auto !important;
    max-width: 100% !important;
  }
}

/* Extra critical fixes for very narrow screens */
@media (max-width: 480px) {
  /* Ultra-compact mode */
  main {
    padding: 8px !important;
  }
  
  /* Reduce all spacing */
  .p-6, .px-6, .py-6 {
    padding: 12px !important;
  }
  
  .p-4, .px-4, .py-4 {
    padding: 8px !important;
  }
  
  /* Smaller gaps in flex/grid */
  .gap-4 {
    gap: 8px !important;
  }
  
  .gap-6 {
    gap: 12px !important;
  }
  
  /* Ensure text doesn't overflow */
  h1, h2, h3, h4, h5, h6, p, span, div {
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
  }
}

/* Debug helper - remove after testing */
@media (max-width: 766px) {
  /* Add visible border to main content to verify it's showing */
  main {
    outline: 2px solid rgba(59, 130, 246, 0.5) !important;
  }
}

/* ============================================
   SPECIFIC COMPONENT FIXES
   ============================================ */

/* Users page specific fixes */
@media (max-width: 766px) {
  /* User list container */
  [class*="UserList"],
  [class*="user-list"] {
    width: 100% !important;
    max-width: 100vw !important;
    overflow-x: hidden !important;
  }
  
  /* User cards */
  [class*="UserCard"],
  [class*="user-card"] {
    width: 100% !important;
    max-width: 100% !important;
    margin-bottom: 12px !important;
  }
  
  /* Ensure page headers don't hide content */
  .border-b {
    position: relative !important;
    width: 100% !important;
  }
  
  /* Action buttons container */
  .flex.gap-2,
  .flex.gap-3,
  .flex.gap-4 {
    flex-wrap: wrap !important;
    width: 100% !important;
  }
}

/* ============================================
   FAILSAFE - LAST RESORT FIX
   ============================================ */
@media (max-width: 766px) {
  /* If content is still hidden, force everything visible */
  body * {
    max-width: 100vw !important;
  }
  
  /* Remove any transforms that might hide content */
  * {
    transform: none !important;
  }
  
  /* Exception: allow transforms on sidebar only */
  aside,
  [class*="sidebar"] {
    transform: translateX(-100%) !important;
  }
  
  aside[style*="display: flex"] {
    transform: translateX(0) !important;
  }
  
  /* Ensure no element has display: none unless it's supposed to */
  main *:not([hidden]):not(.hidden) {
    display: revert !important;
  }
}
